package com.ngames.nclient.module.modules.exploit;

import com.ngames.nclient.NClient;
import com.ngames.nclient.event.Listener;
import com.ngames.nclient.event.NClientEvent;
import com.ngames.nclient.event.NClientEvent.PlayerJumpEvent;
import com.ngames.nclient.module.Category;
import com.ngames.nclient.module.Module;
import com.ngames.nclient.module.Modules;
import com.ngames.nclient.module.ModuleType;
import com.ngames.nclient.module.settings.SettingValue;

import net.minecraft.init.MobEffects;
import net.minecraft.util.math.MathHelper;

@ModuleType(
		category = Category.MOVEMENT, 
		description = "Change your jumps length", 
		name = "LongJump", 
		words = "LongJump JumpLength Speed")
public class LongJump extends Module
{
	private SettingValue length = new SettingValue("Length", 1.1f, 0f, 100f);
	
	public LongJump()
	{
		this.settings = Module.addSettings(this);
	}
	
	@Override
	public void onEnable()
	{
		super.onEnable();
		new Listener(PlayerJumpEvent.class, this);
	}
	
	@Override
	public void onInvoke (NClientEvent event)
	{
		NClient.MC.player.motionY = Modules.highJump.isEnabled() ? 0.42f * Modules.highJump.height.getValue() : 0.42f;

        if (NClient.MC.player.isPotionActive(MobEffects.JUMP_BOOST))
        {
        	NClient.MC.player.motionY += (double)((float)(NClient.MC.player.getActivePotionEffect(MobEffects.JUMP_BOOST).getAmplifier() + 1) * 0.1F);
        }
        float f = NClient.MC.player.rotationYaw * 0.017453292F;
        if (NClient.MC.player.isSprinting())
        {
            NClient.MC.player.motionX -= (double)(MathHelper.sin(f) * 0.2F);
            NClient.MC.player.motionZ += (double)(MathHelper.cos(f) * 0.2F);
        }
        NClient.MC.player.motionX *= this.length.getValue();
        NClient.MC.player.motionZ *= this.length.getValue();
        
        NClient.MC.player.isAirBorne = true;
        net.minecraftforge.common.ForgeHooks.onLivingJump(NClient.MC.player);
        event.setCalceled();
	}
}
